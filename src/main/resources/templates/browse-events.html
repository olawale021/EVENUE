<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Add CSRF token as a meta tag in your HTML head -->
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

  <title>Explore Events</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    /* Any additional styles can be added here */
  </style>
</head>
<body class="bg-gray-30">
<!-- Header Section -->
<div th:insert="~{header :: headerFragment}"></div>
<div class="container mx-auto p-6">
  <h1 class="text-3xl font-bold mb-2 mt-2">Explore Events</h1>
  <p class="text-gray-600 mb-6">Search for something you love or check out popular events in your area.</p>

  <div class="flex">
    <!-- Filters Column -->
    <div class="w-1/4 pr-6">
      <h2 class="text-xl font-bold mb-4">Filters</h2>

      <!-- Category Filter -->
      <div class="mb-4">
        <h3 class="font-semibold mb-2">Category</h3>
        <div th:each="category : ${categories}" class="flex items-center mb-2">
          <input type="checkbox" th:id="${'category-' + category.id}" th:value="${category.id}" class="mr-2">
          <!-- Category icons -->
          <label th:for="${'category-' + category.id}" th:text="${category.name}" class="text-sm"></label>
        </div>
        <a href="#" class="text-blue-600 text-sm">View more</a>
      </div>

      <!-- Date Filter -->
      <div class="mb-4">
        <h3 class="font-semibold mb-2">Date</h3>
        <div th:each="dateOption : ${dateOptions}" class="flex items-center mb-2">
          <input type="radio" th:id="${'date-' + dateOption.value}" th:value="${dateOption.value}" name="date" class="mr-2">
          <label th:for="${'date-' + dateOption.value}" th:text="${dateOption.label}" class="text-sm"></label>
        </div>
        <a href="#" class="text-blue-600 text-sm">View more</a>
      </div>

      <!-- Price Filter -->
      <div class="mb-4">
        <h3 class="font-semibold mb-2">Price</h3>
        <div class="flex items-center mb-2">
          <input type="radio" id="price-free" value="free" name="price" class="mr-2">
          <label for="price-free" class="text-sm">Free</label>
        </div>
        <div class="flex items-center mb-2">
          <input type="radio" id="price-paid" value="paid" name="price" class="mr-2">
          <label for="price-paid" class="text-sm">Paid</label>
        </div>
      </div>

      <!-- Format Filter -->
      <div>
        <h3 class="font-semibold mb-2">Format</h3>
        <div class="flex items-center mb-2">
          <input type="checkbox" id="format-class" value="class" class="mr-2">
          <label for="format-class" class="text-sm">Class</label>
        </div>
        <div class="flex items-center mb-2">
          <input type="checkbox" id="format-conference" value="conference" class="mr-2">
          <label for="format-conference" class="text-sm">Conference</label>
        </div>
      </div>
    </div>

    <!-- Events Column -->
    <div class="w-2/4"> <!-- Changed from w-3/4 to w-2/4 -->
      <div th:each="event : ${events}" class="bg-white rounded-lg p-4 mb-4 transition transform hover:shadow-lg hover:rounded-lg" style="width: 100%; list-style: none">
        <div class="flex">
          <img th:src="${event.eventImage}" alt="Event Image" class="w-1/3 h-32 object-cover rounded-lg mr-4">
          <div class="w-2/3">
            <div class="flex justify-between items-start mb-2">
              <div>
                <h3>
                  <a th:href="@{/events/details/{eventId}(eventId=${event.id})}"
                     th:text="${event.eventName}"
                     class="text-l font-bold text-black hover:underline">
                  </a>
                </h3>
              </div>
              <div class="flex space-x-2">
                <!-- Like/Unlike Form -->
                <form th:action="@{/wishlist/toggleLike}" method="post">
                  <input type="hidden" name="userId" th:value="${loggedInUser.id}">
                  <input type="hidden" name="eventId" th:value="${event.id}">
                  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                  <button type="submit" class="text-gray-400 hover:text-gray-600">
                    <svg th:classappend="${event.isLiked} ? 'w-5 h-5 text-red-500' : 'w-5 h-5 text-gray-400'"
                         id="like-icon-${event.id}" fill="currentColor"
                         xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path d="M12.1 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12.1 21.35Z"/>
                    </svg>
                  </button>

                </form>
              </div>
            </div>
            <div class="flex items-center text-sm text-gray-600 mb-1">
              <p th:text="${event.eventDate}"></p>
              <p class="mx-2">•</p>
              <p th:text="${event.startTime}"></p>
            </div>
            <p th:text="${event.location}" class="text-sm text-gray-600 mb-2"></p>
            <p th:text="${'From £' + event.ticketPrice}" class="font-semibold"></p>
          </div>
        </div>
      </div>

      <!-- Pagination Controls -->
      <div class="flex justify-between items-center mt-6">
        <!-- Previous Page Button -->
        <a th:if="${currentPage > 0}" th:href="@{/events/browse(page=${currentPage - 1}, size=${size})}"
           class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
          Previous
        </a>

        <!-- Current Page Indicator -->
        <span th:text="'Page ' + (${currentPage + 1}) + ' of ' + ${totalPages}" class="px-4 py-2"></span>

        <!-- Next Page Button -->
        <a th:if="${currentPage < totalPages - 1}" th:href="@{/events/browse(page=${currentPage + 1}, size=${size})}"
           class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">
          Next
        </a>
      </div>
    </div>

    <!-- Sponsors Column -->
    <div class="w-1/4">
      <div class="sticky-banner sticky">
        <h2 class="text-xl font-bold mb-4">Our Sponsors</h2>

        <!-- Sponsor Banner 1 -->
        <div class="bg-white shadow-lg rounded-lg p-4 mb-6">
          <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS7J_jO7Ko7S4X7oo0p8OmjF896F34pIALn3A&s" alt="Sponsor Logo" class="w-full h-24 object-contain mb-2">
          <p class="text-gray-600 text-sm mb-2">Check out amazing events sponsored by our partners.</p>
          <a href="#" class="block bg-blue-500 text-white text-center py-2 rounded-md hover:bg-blue-600">Learn More</a>
        </div>

        <!-- Sponsor Banner 2 -->
        <div class="bg-white shadow-lg rounded-lg p-4 mb-6">
          <img src="https://miro.medium.com/v2/resize:fit:1200/1*KGCOY83jkn-cXBfQxTWLcg.png" alt="Sponsor Logo" class="w-full h-24 object-contain mb-2">
          <p class="text-gray-600 text-sm mb-2">Discover exclusive deals and offers from our sponsors.</p>
          <a href="#" class="block bg-green-500 text-white text-center py-2 rounded-md hover:bg-green-600">Explore Offers</a>
        </div>

        <!-- Sponsor Banner 3 -->
        <div class="bg-white shadow-lg rounded-lg p-4 mb-6">
          <img src="https://jdsportsblog.s3.amazonaws.com/wp-content/uploads/2022/01/Desktop_Homepage_Middle_Banner-1704x740_Home.jpg" alt="Sponsor Logo" class="w-full h-24 object-contain mb-2">
          <p class="text-gray-600 text-sm mb-2">Experience top-notch services and products from our sponsors.</p>
          <a href="#" class="block bg-red-500 text-white text-center py-2 rounded-md hover:bg-red-600">Check Services</a>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Footer Section -->
<div th:insert="footer :: footer"></div>
</body>
</html>